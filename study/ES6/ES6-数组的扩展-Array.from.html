<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>ES6-数组的扩展-Array.from</title>
</head>
<body>
	<p>hello</p>
	<p>world</p>
	<p>!</p>
	<span class="name">CAST</span>
	<span class="name">is</span>
	<span class="name">good</span>
	<script>
		//类似数组的对象(array-like)
		let arrayLike = {
			'0': 'a',
			'1': 'b',
			'2': 'c',
			length: 3
		};

		//ES5的写法
		//arrayObject.slice(start,end)中从何处开始选取，从何处结束选取
		var arr1 = [].slice.call(arrayLike); // ['a','b','c']
		console.log(arr1);
		//ES6
		//Array.from方法将两类对象（类似数组的对象、可遍历的对象）转化为真正的数组
		let arr2 = Array.from(arrayLike);
		console.log(arr2);//['a','b','c']




		//NodeList对象
		//querySelectorAll()方法返回一个类似数组的对象
		let ps = document.querySelectorAll('p');
		console.log(ps);
		Array.from(ps).forEach(function (p){
			console.log(p);
		})




		//arguments对象,将arguments对象转化为数组并存储进数组args中，然后用foreach进行遍历输出
		//应该有默认值的情况，但并没有出现
		function foo(x = 1,y = 2){
			var args = Array.from(arguments);
			args.forEach(function(args){
				console.log(args);
			});
		}
		foo(1,2);



		//字符串和Set结构都具有Iterator接口，因此可以被Array.from转为真正的数组
		console.log(Array.from('hello'));
		//['h','e','l','l','o']
		let namesSet = new Set(['a','b']);
		console.log(Array.from(namesSet)) // ['a','b']




		//如果参数是一个真正的数组，Array.from会返回一个一模一样的新数组
		let arr3 = [1,2,3];
		let arr4 = Array.from([1,2,3]);
		console.log(arr3);
		console.log(arr4);
		console.log(arr3 == arr4);




		//扩展运算（...）可以将某些数据结构转为数组
		//将arguments对象转化为数组
		function foo1(){
			var args = [...arguments];
		}




		//将NodeList对象转化为数组
		//[...document.querySelectorAll('div')]




		//有length属性的对象都可以被Array.from方法转化为数组
		console.log(Array.from( { length : 3 } ) );




		//Array.from()接受的第二个参数，其作用类似于数组的map方法
		//数组的map方法是用来对每个元素进行处理，然后将处理后的值放入一个新的数组中并返回
		var arrayLike1 = {
			'0': '1',
			'1': '2',
			'2': '3',
			length: 3
		};
		console.log(Array.from(arrayLike1,x => x * x));
		console.log(Array.from(arrayLike1).map(x => x * x));
		console.log(Array.from([1,2,3],(x) => x * x));



		//取出一组DOM节点的文本内容
		//span.name意思是class为name的span标签
		let spans = document.querySelectorAll('span.name');
		//map()
		let names1 = Array.prototype.map.call(spans, s => s.textContent);
		console.log(names1);
		//Array.from()
		let names2 = Array.from(spans, s => s.textContent);
		console.log(names2);




		//将布尔值为false的成员转为0
		console.log(Array.from([1, ,2, ,3],(n) => n || 0));



		//返回各种数据的类型
		function typesof(){
			return Array.from(arguments, s => typeof s);
		}
		console.log(typesof(null, [ ], NaN));





		//使用数量众多的数组方法
		function repeatedArray(arr_length , arr_value){
			return Array.from( {length: arr_length} , () => arr_value );
		}
		console.log(repeatedArray( 2 , 'jack' ));



		//避免JavaScript将大于\uFFFF的Unicode字符算作两个字符的bug
		console.log("𠮸".length);
		console.log(Array.from("𠮸").length);
	</script>
</body>
</html>